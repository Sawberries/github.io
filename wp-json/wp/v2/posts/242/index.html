{"id":242,"date":"2024-05-03T21:01:17","date_gmt":"2024-05-03T21:01:17","guid":{"rendered":"http:\/\/localhost:8888\/sawberries\/2024\/05\/03\/creating-bespoke-programming-languages-efficient-visual-ai-systems-0503\/"},"modified":"2024-05-03T21:01:17","modified_gmt":"2024-05-03T21:01:17","slug":"creating-bespoke-programming-languages-efficient-visual-ai-systems-0503","status":"publish","type":"post","link":"http:\/\/localhost:8888\/sawberries\/2024\/05\/03\/creating-bespoke-programming-languages-efficient-visual-ai-systems-0503\/","title":{"rendered":"Creating bespoke programming languages for efficient visual AI systems"},"content":{"rendered":"<div>\n<p>A single photograph offers glimpses into the creator\u2019s world \u2014 their interests and feelings about a subject or space. But what about creators behind the technologies that help to make those images possible?\u00a0<\/p>\n<p>MIT Department of Electrical Engineering and Computer Science Associate Professor Jonathan Ragan-Kelley is one such person, who has designed everything from tools for visual effects in movies to the Halide programming language that\u2019s widely used in industry for photo editing and processing. As a researcher with the MIT-IBM Watson AI Lab and the Computer Science and Artificial Intelligence Laboratory, Ragan-Kelley specializes in high-performance, domain-specific programming languages and machine learning that enable 2D and 3D graphics, visual effects, and computational photography.<\/p>\n<p>\u201cThe single biggest thrust through a lot of our research is developing new programming languages that make it easier to write programs that run really efficiently on the increasingly complex hardware that is in your computer today,\u201d says Ragan-Kelley. \u201cIf we want to keep increasing the computational power we can actually exploit for real applications\u00a0\u2014 from graphics and visual computing to AI\u00a0\u2014 we need to change how we program.\u201d<\/p>\n<p><strong>Finding a middle ground<\/strong><\/p>\n<p>Over the last two decades, chip designers and programming engineers have witnessed a slowing of <a href=\"https:\/\/en.wikipedia.org\/wiki\/Moore%27s_law\" target=\"_blank\" rel=\"noopener\">Moore\u2019s law<\/a> and a marked shift from general-purpose computing on CPUs to more varied and specialized computing and processing units like GPUs and accelerators. With this transition comes a trade-off: the ability to run general-purpose code somewhat slowly on CPUs, for faster, more efficient hardware that requires code to be heavily adapted to it and mapped to it with tailored programs and compilers. Newer hardware with improved programming can better support applications like high-bandwidth cellular radio interfaces, decoding highly compressed videos for streaming, and graphics and video processing on power-constrained cellphone cameras, to name a few applications.<\/p>\n<p>\u201cOur work is largely about unlocking the power of the best hardware we can build to deliver as much computational performance and efficiency as possible for these kinds of applications in ways that that traditional programming languages don&#8217;t.\u201d<\/p>\n<p>To accomplish this, Ragan-Kelley breaks his work down into two directions. First, he sacrifices generality to capture the structure of particular and important computational problems and exploits that for better computing efficiency. This can be seen in the image-processing language Halide, which he co-developed and has helped to transform the image editing industry in programs like Photoshop. Further, because it is specially designed to quickly handle dense, regular arrays of numbers (tensors), it also works well for neural network computations. The second focus targets automation, specifically how compilers map programs to hardware. One such project with the MIT-IBM Watson AI Lab leverages Exo, a language developed in Ragan-Kelley\u2019s group.<\/p>\n<p>Over the years, researchers have worked doggedly to automate coding with compilers, which can be a black box; however, there\u2019s still a large need for explicit control and tuning by performance engineers. Ragan-Kelley and his group are developing methods that straddle each technique, balancing trade-offs to achieve effective and resource-efficient programming. At the core of many high-performance programs like video game engines or cellphone camera processing are state-of-the-art systems that are largely hand-optimized by human experts in low-level, detailed languages like C, C++, and assembly. Here, engineers make specific choices about how the program will run on the hardware.<\/p>\n<p>Ragan-Kelley notes that programmers can opt for \u201cvery painstaking, very unproductive, and very unsafe low-level code,\u201d which could introduce bugs, or \u201cmore safe, more productive, higher-level programming interfaces,\u201d that lack the ability to make fine adjustments in a compiler about how the program is run, and usually deliver lower performance. So, his team is trying to find a middle ground. \u201cWe&#8217;re trying to figure out how to provide control for the key issues that human performance engineers want to be able to control,\u201d says Ragan-Kelley, \u201cso, we&#8217;re trying to build a new class of languages that we call user-schedulable languages that give safer and higher-level handles to control what the compiler does or control how the program is optimized.\u201d<\/p>\n<p><strong>Unlocking hardware: high-level and underserved ways<\/strong><\/p>\n<p>Ragan-Kelley and his research group are tackling this through two lines of work: applying machine learning and modern AI techniques to automatically generate optimized schedules, an interface to the compiler, to achieve better compiler performance. Another uses \u201cexocompilation\u201d that he\u2019s working on with the lab. He describes this method as a way to \u201cturn the compiler inside-out,\u201d with a skeleton of a compiler with controls for human guidance and customization. In addition, his team can add their bespoke schedulers on top, which can help target specialized hardware like machine-learning accelerators from IBM Research. Applications for this work span the gamut: computer vision, object recognition, speech synthesis, image synthesis, speech recognition, text generation (large language models), etc.<\/p>\n<p>A big-picture project of his with the lab takes this another step further, approaching the work through a systems lens. In work led by his advisee and lab intern William Brandon, in collaboration with lab research scientist Rameswar Panda, Ragan-Kelley\u2019s team is rethinking large language models (LLMs), finding ways to change the computation and the model\u2019s programming architecture slightly so that the transformer-based models can run more efficiently on AI hardware without sacrificing accuracy. Their work, Ragan-Kelley says, deviates from the standard ways of thinking in significant ways with potentially large payoffs for cutting costs, improving capabilities, and\/or shrinking the LLM to require less memory and run on smaller computers.<\/p>\n<p>It&#8217;s this more avant-garde thinking, when it comes to computation efficiency and hardware, that Ragan-Kelley excels at and sees value in, especially in the long term. \u201cI think there are areas [of research] that need to be pursued, but are well-established, or obvious, or are conventional-wisdom enough that lots of people either are already or will pursue them,\u201d he says. \u201cWe try to find the ideas that have both large leverage to practically impact the world, and at the same time, are things that wouldn&#8217;t necessarily happen, or I think are being underserved relative to their potential by the rest of the community.\u201d<\/p>\n<p>The course that he now teaches, 6.106 (Software Performance Engineering), exemplifies this. About 15 years ago, there was a shift from single to multiple processors in a device that caused many academic programs to begin teaching parallelism. But, as Ragan-Kelley explains, MIT realized the importance of students understanding not only parallelism but also optimizing memory and using specialized hardware to achieve the best performance possible.<\/p>\n<p>\u201cBy changing how we program, we can unlock the computational potential of new machines, and make it possible for people to continue to rapidly develop new applications and new ideas that are able to exploit that ever-more complicated and challenging hardware.\u201d<\/p>\n<\/div>\n","protected":false},"excerpt":{"rendered":"<p>A single photograph offers glimpses into the creator\u2019s world \u2014 their interests and feelings about a subject or space. But what about creators behind the technologies that help to make those images possible?\u00a0 MIT Department of Electrical Engineering and Computer Science Associate Professor Jonathan Ragan-Kelley is one such person, who has designed everything from tools [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[17,509,57,53,397,58,80,388,508,39,60,66,131,230,236,59,105],"tags":[],"_links":{"self":[{"href":"http:\/\/localhost:8888\/sawberries\/wp-json\/wp\/v2\/posts\/242"}],"collection":[{"href":"http:\/\/localhost:8888\/sawberries\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost:8888\/sawberries\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost:8888\/sawberries\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost:8888\/sawberries\/wp-json\/wp\/v2\/comments?post=242"}],"version-history":[{"count":0,"href":"http:\/\/localhost:8888\/sawberries\/wp-json\/wp\/v2\/posts\/242\/revisions"}],"wp:attachment":[{"href":"http:\/\/localhost:8888\/sawberries\/wp-json\/wp\/v2\/media?parent=242"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost:8888\/sawberries\/wp-json\/wp\/v2\/categories?post=242"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost:8888\/sawberries\/wp-json\/wp\/v2\/tags?post=242"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}